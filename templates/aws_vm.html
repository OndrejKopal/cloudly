{% extends "base.html" %}

{% load cloud_extras %}
						
{% block title %}Amazon EC2 Virtual Machine {{vm_name|upper}}{% endblock %}

{% block page_content %}

<div class="col-md-10 col-sm-11 main ">

	<ol class="breadcrumb">
	  	<li><a href="/">Virtual Machines</a></li>
	  	<li class="active">Amazon EC2 {{vm_name|upper}}</li>
	</ol>

	<div class="row">
		<div class="col-xs-12">
			<div class="panel panel-default">
					<div class="panel-heading">
						<h2><i class="fa fa-truck"></i>{{vm_name}}</h2>
						<div class="panel-actions">
							<a href="#" class="btn-setting"><i class="fa fa-wrench"></i></a>
							<a href="#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
							<a href="#" class="btn-close"><i class="fa fa-times"></i></a>
						</div>
					</div>
					<div class="panel-body">

<pre>
<strong>instance</strong> 
{% for vm in vm_cache|dict_get:"instance" %}
<strong>{{vm}}</strong> {{vm_cache|dict_get:"instance"|dict_get:vm}}{% endfor %}
</pre>	


                                </div><!--/col-->
                </div><!--/row-->	
        </div>
        <!-- end: Content -->
</div><!--/row-->

<div class="row">
    <div class="col-xs-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                    <h2><i class="fa fa-truck"></i>System metrics</h2>
                    <div class="panel-actions">
                            <a href="#" class="btn-setting"><i class="fa fa-wrench"></i></a>
                            <a href="#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                            <a href="#" class="btn-close"><i class="fa fa-times"></i></a>
                    </div>
            </div>
            <div class="panel-body">
                
                <div id="CPU-Metrics"></div>
                <br />
                <div id="network-metrics"></div>
                <br />
                <div id="hdd-metrics"></div>
<!--                <pre>
                <strong>vm_cache</strong>
                {% for graph in vm_cache %}
                <strong>{{graph}}</strong> {{vm_cache|dict_get:graph}}
                {% endfor %}
                </pre>-->



<pre>
<strong>Debug:</strong> vm_cache
cpu_utilization_datapoints
networkout_datapoints
networkin_datapoints
disk_writeops_datapoints
disk_readops_datapoints
disk_writebytes_datapoints
disk_readbytes_datapoints
</pre>
>>>>>>> 4e9750ff655a42c7e912a1dd719df657d702cd04


            </div><!--/col-->

</div><!--/row-->	
						
<div class="row">
        <div class="col-xs-12">
                <div class="panel panel-default">
                                <div class="panel-heading">
                                        <h2><i class="fa fa-truck"></i>Alerts</h2>
                                        <div class="panel-actions">
                                                <a href="#" class="btn-setting"><i class="fa fa-wrench"></i></a>
                                                <a href="#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                                                <a href="#" class="btn-close"><i class="fa fa-times"></i></a>
                                        </div>
                                </div>
                                <div class="panel-body">
                                        TBD
                                </div><!--/col-->
                </div><!--/row-->	
        </div>
        <!-- end: Content -->
</div><!--/row-->

<div class="row">
        <div class="col-xs-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                            <h2><i class="fa fa-truck"></i>Console output</h2>
                            <div class="panel-actions">
                                    <a href="#" class="btn-setting"><i class="fa fa-wrench"></i></a>
                                    <a href="#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                                    <a href="#" class="btn-close"><i class="fa fa-times"></i></a>
                            </div>
                    </div>
                    <div class="panel-body" style="display: none;">

<pre>
Console output:
{{console_output}}
</pre>	


                </div><!--/col-->
</div><!--/row-->	


<div class="row">
        <div class="col-xs-12">
                <div class="panel panel-default">
                                <div class="panel-heading">
                                        <h2><i class="fa fa-truck"></i>Estimated cost</h2>
                                        <div class="panel-actions">
                                                <a href="#" class="btn-setting"><i class="fa fa-wrench"></i></a>
                                                <a href="#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                                                <a href="#" class="btn-close"><i class="fa fa-times"></i></a>
                                        </div>
                                </div>
                                <div class="panel-body">
                                        TBD
                                </div><!--/col-->
                </div><!--/row-->	
        </div>
        <!-- end: Content -->
</div><!--/row-->

</div>
<!-- end: Content -->

<div class="panel-body">


{% if vm_cache|dict_get:"instance"|dict_get:"state"|dict_get:"state" == "running" %}
        <a href="/aws/{{vm_name}}/request/help/"><button type="button" class="btn btn-default">Request Help</button></a>
        <div class="btn-group dropup">
                <button type="button" class="btn btn-warning">Remote desktop</button>
                <button type="button" class="btn btn-warning dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
                <span class="sr-only">Toggle Dropdown</span>
                </button>
                <ul class="dropdown-menu" role="menu">
                <li><a href="/aws/{{vm_name}}/stop/">Stop</a></li>
                <li><a href="/aws/{{vm_name}}/terminate/">Terminate</a></li>
                <li class="divider"></li>
                <li><a href="#">Duplicate</a></li>
                <li><a href="#">Assign a static IP</a></li>
                <li><a href="#">Enable auto-scaling</a></li>
                <li><a href="#">Backup to the Cloud</a></li>
                <li class="divider"></li>
                <li class="divider"></li>
                <li><a href="#">Remote desktop</a></li>
                </ul>
        </div>
{% endif %}

{% if vm_cache|dict_get:"instance"|dict_get:"state"|dict_get:"state" == "stopped" %}
        <a href="/aws/{{vm_name}}/start/"><button type="button" class="btn btn-success">Start</button></a>
        <a href="/aws/{{vm_name}}/terminate/"><button type="button" class="btn btn-danger">Terminate</button></a>
        <a href="/aws/{{vm_name}}/request/help/"><button type="button" class="btn btn-default">Request Help</button></a>
        <a href="#"></a>
        <a href="#"></a>
{% endif %}


</div>	

</div>
<!-- end: Content -->


</div><!--/row-->

</div><!--/row-->



</div><!--/container-->

	<div class="modal fade" id="myModal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 class="modal-title">Modal title</h4>
				</div>
				<div class="modal-body">
					<p>Here settings can be configured...</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary">Save changes</button>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->

{% endblock page_content %}

{% block extra_js %}
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<script type="text/javascript">
    <!--
    
    $(function () {
        //CPU metrics
        $('#CPU-Metrics').highcharts({
            chart: {
                type: 'spline'
            },
            title: {
                text: 'CPU Metrics'
            },
            subtitle: {
                text: 'Irregular time data in Highcharts JS'
            },
            xAxis: {
                type: 'datetime',
                dateTimeLabelFormats: { // don't display the dummy year
                    month: '%e. %b',
                    year: '%b'
                },
                title: {
                    text: 'Date and time'
                }
            },
            yAxis: {
                title: {
                    text: 'Snow depth (m)'
                },
                min: 0
            },
            tooltip: {
                headerFormat: '<b>{series.name}</b><br>',
                pointFormat: '{point.x:%e. %b}: {point.y:.2f} m'
            },

            series: [{
                name: 'Average',
                // Define the data points. All series have a dummy year
                // of 1970/71 in order to be compared on the same x axis. Note
                // that in JavaScript, months start at 0 for January, 1 for February etc.
                data: [
                    [Date.UTC(1970,  9, 27), 0   ],
                    [Date.UTC(1970, 10, 10), 0.6 ],
                    [Date.UTC(1970, 10, 18), 0.7 ],
                    [Date.UTC(1970, 11,  2), 0.8 ],
                    [Date.UTC(1970, 11,  9), 0.6 ],
                    [Date.UTC(1970, 11, 16), 0.6 ],
                    [Date.UTC(1970, 11, 28), 0.67],
                    [Date.UTC(1971,  0,  1), 0.81],
                    [Date.UTC(1971,  0,  8), 0.78],
                    [Date.UTC(1971,  0, 12), 0.98],
                    [Date.UTC(1971,  0, 27), 1.84],
                    [Date.UTC(1971,  1, 10), 1.80],
                    [Date.UTC(1971,  1, 18), 1.80],
                    [Date.UTC(1971,  1, 24), 1.92],
                    [Date.UTC(1971,  2,  4), 2.49],
                    [Date.UTC(1971,  2, 11), 2.79],
                    [Date.UTC(1971,  2, 15), 2.73],
                    [Date.UTC(1971,  2, 25), 2.61],
                    [Date.UTC(1971,  3,  2), 2.76],
                    [Date.UTC(1971,  3,  6), 2.82],
                    [Date.UTC(1971,  3, 13), 2.8 ],
                    [Date.UTC(1971,  4,  3), 2.1 ],
                    [Date.UTC(1971,  4, 26), 1.1 ],
                    [Date.UTC(1971,  5,  9), 0.25],
                    [Date.UTC(1971,  5, 12), 0   ]
                ]
            }]
        });
        
        //network metrics
        $('#network-metrics').highcharts({
            chart: {
                type: 'spline'
            },
            title: {
                text: 'Network metrics'
            },
            subtitle: {
                text: 'Irregular time data in Highcharts JS'
            },
            xAxis: {
                type: 'datetime',
                dateTimeLabelFormats: { // don't display the dummy year
                    month: '%e. %b',
                    year: '%b'
                },
                title: {
                    text: 'Date and time'
                }
            },
            yAxis: {
                title: {
                    text: 'Snow depth (m)'
                },
                min: 0
            },
            tooltip: {
                headerFormat: '<b>{series.name}</b><br>',
                pointFormat: '{point.x:%e. %b}: {point.y:.2f} m'
            },

            series: [{
                name: 'Up',
                // Define the data points. All series have a dummy year
                // of 1970/71 in order to be compared on the same x axis. Note
                // that in JavaScript, months start at 0 for January, 1 for February etc.
                data: [
                    [Date.UTC(1970,  9, 27), 0   ],
                    [Date.UTC(1970, 10, 10), 0.6 ],
                    [Date.UTC(1970, 10, 18), 0.7 ],
                    [Date.UTC(1970, 11,  2), 0.8 ],
                    [Date.UTC(1970, 11,  9), 0.6 ],
                    [Date.UTC(1970, 11, 16), 0.6 ],
                    [Date.UTC(1970, 11, 28), 0.67],
                    [Date.UTC(1971,  0,  1), 0.81],
                    [Date.UTC(1971,  0,  8), 0.78],
                    [Date.UTC(1971,  0, 12), 0.98],
                    [Date.UTC(1971,  0, 27), 1.84],
                    [Date.UTC(1971,  1, 10), 1.80],
                    [Date.UTC(1971,  1, 18), 1.80],
                    [Date.UTC(1971,  1, 24), 1.92],
                    [Date.UTC(1971,  2,  4), 2.49],
                    [Date.UTC(1971,  2, 11), 2.79],
                    [Date.UTC(1971,  2, 15), 2.73],
                    [Date.UTC(1971,  2, 25), 2.61],
                    [Date.UTC(1971,  3,  2), 2.76],
                    [Date.UTC(1971,  3,  6), 2.82],
                    [Date.UTC(1971,  3, 13), 2.8 ],
                    [Date.UTC(1971,  4,  3), 2.1 ],
                    [Date.UTC(1971,  4, 26), 1.1 ],
                    [Date.UTC(1971,  5,  9), 0.25],
                    [Date.UTC(1971,  5, 12), 0   ]
                ]
            },{
                name: 'Down',
                // Define the data points. All series have a dummy year
                // of 1970/71 in order to be compared on the same x axis. Note
                // that in JavaScript, months start at 0 for January, 1 for February etc.
                data: [
                    [Date.UTC(1970,  9, 27), 4   ],
                    [Date.UTC(1970, 10, 10), 2.6 ],
                    [Date.UTC(1970, 10, 18), 3.7 ],
                    [Date.UTC(1970, 11,  2), 2.8 ],
                    [Date.UTC(1970, 11,  9), 1.6 ],
                    [Date.UTC(1970, 11, 16), 5.6 ],
                    [Date.UTC(1970, 11, 28), 8.67],
                    [Date.UTC(1971,  0,  1), 1.81],
                    [Date.UTC(1971,  0,  8), 3.78],
                    [Date.UTC(1971,  0, 12), 2.98],
                    [Date.UTC(1971,  0, 27), 1.84],
                    [Date.UTC(1971,  1, 10), 1.80],
                    [Date.UTC(1971,  1, 18), 1.80],
                    [Date.UTC(1971,  1, 24), 1.92],
                    [Date.UTC(1971,  2,  4), 2.49],
                    [Date.UTC(1971,  2, 11), 4.79],
                    [Date.UTC(1971,  2, 15), 7.73],
                    [Date.UTC(1971,  2, 25), 9.61],
                    [Date.UTC(1971,  3,  2), 9.76],
                    [Date.UTC(1971,  3,  6), 10.82],
                    [Date.UTC(1971,  3, 13), 11.8 ],
                    [Date.UTC(1971,  4,  3), 10.1 ],
                    [Date.UTC(1971,  4, 26), 4.1 ],
                    [Date.UTC(1971,  5,  9), 2.25],
                    [Date.UTC(1971,  5, 12), 1   ]
                ]
            }]
        });
    });
    
    //disk metrics
    $(function () {
    $('#hdd-metrics').highcharts({
        chart: {
            type: 'area'
        },
        title: {
            text: 'Disk usage metrics'
        },
        subtitle: {
            text: ''
        },
        xAxis: {
            type: 'datetime'
        },
        yAxis: {
            title: {
                text: null
            }            
        },
        tooltip: {
            pointFormat: 'Something here Load, IO etc'
        },
        plotOptions: {
            area: {
                pointStart: 100,                
            }
        },
        series: [{
            name: 'I/O',
            data: [null, null, null, null, null, 6, 11, 32, 110, 235, 369, 640,
                1005, 1436, 2063, 3057, 4618, 6444, 9822, 15468, 20434, 24126,
                27387, 29459, 31056, 31982, 32040, 31233, 29224, 27342, 26662,
                26956, 27912, 28999, 28965, 27826, 25579, 25722, 24826, 24605,
                24304, 23464, 23708, 24099, 24357, 24237, 24401, 24344, 23586,
                22380, 21004, 17287, 14747, 13076, 12555, 12144, 11009, 10950,
                10871, 10824, 10577, 10527, 10475, 10421, 10358, 10295, 10104]
        }, {
            name: 'Read/Write',
            data: [null, null, null, null, null, null, null, null, null, null,
                5, 25, 50, 120, 150, 200, 426, 660, 869, 1060, 1605, 2471, 3322,
                4238, 5221, 6129, 7089, 8339, 9399, 10538, 11643, 13092, 14478,
                15915, 17385, 19055, 21205, 23044, 25393, 27935, 30062, 32049,
                33952, 35804, 37431, 39197, 45000, 43000, 41000, 39000, 37000,
                35000, 33000, 31000, 29000, 27000, 25000, 24000, 23000, 22000,
                21000, 20000, 19000, 18000, 18000, 17000, 16000]
        }]
    });
});
    
    //-->
</script>

{% endblock extra_js %}

